---
date: 2025-08-24 12:40:01
title: 配置algolia
permalink: /pages/20b6a7
description: '文章系统地说明了配置Algolia搜索的全过程，包括账号注册、应用和索引创建、域名验证、爬虫配置、索引设置以及前端代码集成。通过详细步骤和示例，帮助用户快速搭建并优化网站搜索功能，特别强调了facets配置中lang属性的重要性，确保搜索结果正常显示。'
author:
  name: 华总
  link: https://xiaoying.org.cn
categories:
  - 工具类
  - 本站插件
---

## 1、注册账号

首先需要去 [algolia](https://www.algolia.com/) 官网注册自己的账号，可以直接使用 Github 或者其他邮箱注册登录。

新账号会自动创建一个*Application* ，也可以自己创建一个新的

![image-20250824130816421](https://img.xiaoying.org.cn/img/20250824130816604.png)

![image-20250824130142558](https://img.xiaoying.org.cn/img/20250824130142740.png)

点击确定后接着下一个页面继续点击`create Application`按钮，然后点击`NEXT`就创建了一个新的Application，创建完成后点击
`Skip for now`，不然会根据域名生成index名称，爬虫配置也不对
![image-20250824130516564](https://img.xiaoying.org.cn/img/20250824130516767.png)

## 2、新建index

按下图步骤创建index

![image-20250824131152530](https://img.xiaoying.org.cn/img/20250824131152726.png)

## 3、验证域名

按要求验证域名
![image-20250824131514561](https://img.xiaoying.org.cn/img/20250824131514756.png)

然后点击`Skip for now`进行下一步骤

## 4、配置爬虫

按下图所示新建爬虫

![image-20250824133254539](https://img.xiaoying.org.cn/img/20250824133254740.png)

新建后点击爬虫名称进入爬虫配置

![image-20250824135124409](https://img.xiaoying.org.cn/img/20250824135124624.png)

爬虫配置如下，将域名和indexName名称改成自己配置的，配置完成后点击右上角`start Crawling`开始爬取网站内容

```js
new Crawler({
  appId: "...",
  apiKey: "...",
  rateLimit: 8,
  startUrls: ["https://vp.xiaoying.org.cn/"],  // [!code highlight]
  renderJavaScript: false,
  sitemaps: ["https://vp.xiaoying.org.cn/sitemap.xml"], // [!code highlight] 
  exclusionPatterns: ["https://vp.xiaoying.org.cn/config/theme"], // [!code highlight]
  ignoreCanonicalTo: false,
  discoveryPatterns: ["https://vp.xiaoying.org.cn/**"], // [!code highlight]
  schedule: "at 5:10 on saturday",
  actions: [
    {
      indexName: "blog", // [!code highlight]
      pathsToMatch: ["https://vp.xiaoying.org.cn/**"], // [!code highlight]
      recordExtractor: ({ url, $, helpers }) => {
        // 提取代码片段
        const codeSnippets = helpers.codeSnippets({
          tag: "pre",
          languageClassPrefix: "language-",
        });

        // 提取文档结构信息
        const docRecords = helpers.docsearch({
          recordProps: {
            lvl1: ".content h1",
            content: ".content p, .content li",
            lvl0: {
              selectors: "section.has-active div h2",
              defaultValue: "Documentation",
            },
            lvl2: ".content h2",
            lvl3: ".content h3",
            lvl4: ".content h4",
            lvl5: ".content h5",
          },
          indexHeadings: true,
          recordVersion: "v3",
        });

        // 将代码片段合并到每个文档记录中
        return docRecords.map((record) => ({
          ...record,
          code: codeSnippets, // 添加代码片段字段
          url: url, // 确保URL被包含
        }));
      },
    },
  ],
  initialIndexSettings: {
    blog: { // [!code highlight]
      attributesForFaceting: ["type", "lang"],
      attributesToRetrieve: ["hierarchy", "content", "anchor", "url"],
      attributesToHighlight: ["hierarchy", "hierarchy_camel", "content"],
      attributesToSnippet: ["content:10"],
      camelCaseAttributes: ["hierarchy", "hierarchy_radio", "content"],
      searchableAttributes: [
        "unordered(hierarchy_radio_camel.lvl0)",
        "unordered(hierarchy_radio.lvl0)",
        "unordered(hierarchy_radio_camel.lvl1)",
        "unordered(hierarchy_radio.lvl1)",
        "unordered(hierarchy_radio_camel.lvl2)",
        "unordered(hierarchy_radio.lvl2)",
        "unordered(hierarchy_radio_camel.lvl3)",
        "unordered(hierarchy_radio.lvl3)",
        "unordered(hierarchy_radio_camel.lvl4)",
        "unordered(hierarchy_radio.lvl4)",
        "unordered(hierarchy_radio_camel.lvl5)",
        "unordered(hierarchy_radio.lvl5)",
        "unordered(hierarchy_radio_camel.lvl6)",
        "unordered(hierarchy_radio.lvl6)",
        "unordered(hierarchy_camel.lvl0)",
        "unordered(hierarchy.lvl0)",
        "unordered(hierarchy_camel.lvl1)",
        "unordered(hierarchy.lvl1)",
        "unordered(hierarchy_camel.lvl2)",
        "unordered(hierarchy.lvl2)",
        "unordered(hierarchy_camel.lvl3)",
        "unordered(hierarchy.lvl3)",
        "unordered(hierarchy_camel.lvl4)",
        "unordered(hierarchy.lvl4)",
        "unordered(hierarchy_camel.lvl5)",
        "unordered(hierarchy.lvl5)",
        "unordered(hierarchy_camel.lvl6)",
        "unordered(hierarchy.lvl6)",
        "content",
      ],
      distinct: true,
      attributeForDistinct: "url",
      customRanking: [
        "desc(weight.pageRank)",
        "desc(weight.level)",
        "asc(weight.position)",
      ],
      ranking: [
        "words",
        "filters",
        "typo",
        "attribute",
        "proximity",
        "exact",
        "custom",
      ],
      highlightPreTag: '<span class="algolia-docsearch-suggestion--highlight">',
      highlightPostTag: "</span>",
      minWordSizefor1Typo: 3,
      minWordSizefor2Typos: 7,
      allowTyposOnNumericTokens: false,
      minProximity: 1,
      ignorePlurals: true,
      advancedSyntax: true,
      attributeCriteriaComputedByMinProximity: true,
      removeWordsIfNoResults: "allOptional",
    },
  },
});
```

## 5、索引设置

回到搜索页面看是否有数据

![image-20250824134034515](https://img.xiaoying.org.cn/img/20250824134034744.png)

接着配置索引，选择要搜索的内容

![image-20250824134400340](https://img.xiaoying.org.cn/img/20250824134400554.png)

接着配置facets，这是实现高级搜索和筛选功能的核心特性之一，主要作用是帮助用户快速缩小搜索范围，提升搜索体验，这里要重点注意
`lang`必须被选择，否则网页搜索为空

![image-20250824134630115](https://img.xiaoying.org.cn/img/20250824134630329.png)

## 6、代码配置

按图所示找到下面的配置

![image-20250824135518386](https://img.xiaoying.org.cn/img/20250824135518604.png)

![image-20250824135844855](https://img.xiaoying.org.cn/img/20250824135845066.png)

![image-20250824135939156](https://img.xiaoying.org.cn/img/20250824135939358.png)

```ts
export default defineConfig({
   ...
    lang: "zh-CN",
   ...
    themeConfig: ({
      ...
        search: {
            provider: 'algolia',
            options: {
                appId: '...',
                apiKey: '...',
                indexName: '...'
            },
        } 
      ...
    })
})

```



