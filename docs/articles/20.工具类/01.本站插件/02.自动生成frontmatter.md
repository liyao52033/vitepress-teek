---
date: 2025-03-18 00:03:50
title: è‡ªåŠ¨ç”Ÿæˆfrontmatter
permalink: /pages/3ab292
description: >-
  ä¸€ä¸ªç”¨äº VitePress çš„æ’ä»¶ï¼Œèƒ½è‡ªåŠ¨ä¸º Markdown æ–‡ä»¶ç”Ÿæˆæ ‡é¢˜å’Œæ—¥æœŸç­‰
  frontmatterï¼Œæ”¯æŒç”¨æˆ·è‡ªå®šä¹‰æ‰©å±•å†…å®¹ã€‚é€šè¿‡ç®€å•å®‰è£…å’Œé…ç½®å³å¯ä½¿ç”¨ï¼Œå¹¶èƒ½ç»“åˆ vitepress-plugin-catalogue
  æ’ä»¶æ·»åŠ æ°¸ä¹…é“¾æ¥å’Œåˆ†ç±»æ ‡ç­¾ã€‚è¯¥æ’ä»¶ä»…åœ¨é¡¹ç›®å¯åŠ¨æ—¶ç”Ÿæ•ˆï¼Œæœ‰æ•ˆæå‡æ–‡æ¡£ç®¡ç†çš„è‡ªåŠ¨åŒ–å’Œè§„èŒƒåŒ–æ°´å¹³ã€‚
tags:
  - æ’ä»¶
categories:
  - å·¥å…·ç±»
author:
  name: liyao
  link: https://xiaoying.org.cn
---



# vitepress-plugin-setfrontmatter

## githubåœ°å€

::: navCard  2

```yaml
- name: vitepress-plugin-setfrontmatter
  desc: è¿™æ˜¯ä¸€ä¸ªé€‚ç”¨äºvitepressçš„ Vite æ’ä»¶ï¼Œvitepresså¯åŠ¨æ—¶ï¼Œæ’ä»¶ä¼šç»™æŒ‡å®šçš„ markdown è‡ªåŠ¨ç”Ÿæˆfrontmatterã€‚
  img: https://img.xiaoying.org.cn/img/202503231752583.png
  link: https://github.com/liyao52033/vitepress-plugin-setfrontmatter
  badge: vitepressæ’ä»¶
  badgeType: tip
```

:::



## âœ¨ ç‰¹æ€§

- ğŸš€ è‡ªåŠ¨ç”Ÿæˆ `frontmatter`
- ğŸš€ æ”¯æŒè‡ªå®šä¹‰æ–°çš„ `frontmatter`

## å®‰è£…

å®‰è£… `vitepress-plugin-setfrontmatter` æ’ä»¶

::: code-group

```shell [npm]
npm install vitepress-plugin-setfrontmatter -D
```

```shell [yarn]
yarn add vitepress-plugin-setfrontmatter -D
```

```shell [pnpm]
pnpm i vitepress-plugin-setfrontmatter -D
```

:::

## åŸºæœ¬ä½¿ç”¨

æ·»åŠ  `vitepress-plugin-setfrontmatter` æ’ä»¶åˆ° `.vitepress/config.ts`

```typescript
import AutoFrontmatter from "vitepress-plugin-auto-frontmatter";

export default defineConfig({
  vite: {
    plugins: [AutoFrontmatter({
       pattern: "**/*.md",
       globOptions: { ignore: [""] } //å¿½ç•¥çš„æ–‡ä»¶å¤¹
    })],
  },
});
```

> è¯´æ˜ï¼šè¯¥æ’ä»¶ä»…é™é¡¹ç›®å¯åŠ¨æ—¶ç”Ÿæ•ˆã€‚

## å‚æ•°

```typescript
import type { GlobOptions } from "tinyglobby";

export interface AutoFrontmatterOption {
  /**
   * æ‰«æçš„æ–‡ä»¶è·¯å¾„è¡¨è¾¾å¼ï¼Œä¸º global è¡¨è¾¾å¼
   */
  pattern?: string | string[];
  /**
   * tinyglobby çš„é…ç½®é¡¹
   * æ’ä»¶é»˜è®¤å·²ç»å¿½ç•¥ node_modules å’Œ dist ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶
   */
  globOptions?: GlobOptions;
  
  /**
   * è½¬æ¢å¤„ç†å¥½çš„ frontmatterï¼Œè¯¥å‡½æ•°éœ€è¦è¿”å›ä¸€ä¸ªæ–°çš„ frontmatter æˆ–åªè¿”å› undefinedï¼Œå¦‚æœè¿”å› {}ï¼Œåˆ™æ¸…ç©º MD æ–‡ä»¶æœ¬èº«å­˜åœ¨çš„ frontmatter
   */
  transform?: (frontmatter: Record<string, any>, fileInfo: FileInfo) => Record<string, any> | void;
}

export interface FileInfo {
  /**
   * æ–‡ä»¶ç»å¯¹è·¯å¾„
   */
  filePath: string;
  /**
   * æ–‡ä»¶ç›¸å¯¹è·¯å¾„
   */
  relativePath: string;
}
```



æ’ä»¶é»˜è®¤å¿½ç•¥ ["node_modules", "dist"]` ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œä¸”åªæ‰«æ markdown æ–‡æ¡£ã€‚

æ’ä»¶é»˜è®¤ç»™ markdown æ–‡ä»¶ç”Ÿæˆ `title` å’Œ `date` ä¸¤ä¸ªå±æ€§ï¼Œå…¶ä¸­ `title` ä¸ºæ–‡ä»¶åï¼ˆæ”¯æŒå¸¦åºå·çš„æ–‡ä»¶åï¼Œå¦‚ `01.xx.md`ï¼‰ï¼Œ`date` ä¸ºæ–‡ä»¶çš„åˆ›å»ºæ—¥æœŸã€‚

```yaml
---
title: æ–‡ä»¶å
date: yyyy-MM-dd hh:mm:ss
---
```


## ğŸ“– è‡ªå®šä¹‰æ–°çš„ `frontmatter`

å¦‚æœæƒ³æ‹“å±• `frontmatter` çš„å†…å®¹ï¼Œåˆ™ä½¿ç”¨ `transform` å‡½æ•°ã€‚

æƒ³æ’é™¤æŸä¸ªmdæ–‡æ¡£ä¸æƒ³è‡ªåŠ¨ç”Ÿæˆ `frontmatter`ï¼Œåœ¨`frontmatter` ä¸­æ·»åŠ  `article: false` æˆ–è€… `layout: home`ï¼Œåˆ™ä¸ä¼šç”Ÿæˆ `frontmatter`ã€‚

```yaml
//è¦æ’é™¤çš„è¯äºŒé€‰ä¸€å³å¯
---
article: false 
layout: home
---
```

é€šè¿‡ `transform` å‡½æ•°æ¥æ·»åŠ ä¸€ä¸ªå”¯ä¸€çš„æ°¸ä¹…é“¾æ¥å’Œåˆ†ç±»æ ‡ç­¾

### 1ã€å®‰è£…vitepress-plugin-catalogue

::: code-group

```shell [npm]
npm install vitepress-plugin-catalogue -D
```

```shell [yarn]
yarn add vitepress-plugin-catalogue -D
```

```shell [pnpm]
pnpm i vitepress-plugin-catalogue -D
```

:::

### 2ã€æ–°å»ºtypes.ts

```typescript
import type { CatalogueOption } from "vitepress-plugin-catalogue";
import type { AutoFrontmatterOption } from "vitepress-plugin-auto-frontmatter";

export interface vpThemeConfig {
  /**
   * å†…ç½® Vite æ’ä»¶é…ç½®
   */
  vitePlugins?: Plugins;
}

export interface Plugins {
  /**
   * catalogues æ’ä»¶é…ç½®é¡¹
   */
  catalogueOption?: CatalogueOption;
  /**
   * autoFrontmatter æ’ä»¶é…ç½®é¡¹ï¼Œå¹¶æ‹“å±•å‡ºå…¶ä»–é…ç½®é¡¹
   */
  autoFrontmatterOption?: AutoFrontmatterOption & { permalinkPrefix?: string;};
}

```

### 3ã€é…ç½®

```typescript
export default function vpThemeConfig(config: vpThemeConfig = {}): UserConfig {
  const { vitePlugins,  ...tkThemeConfig } = config;
  const {
    autoFrontmatter = true,
    autoFrontmatterOption = {},
  } = vitePlugins || {};

  const plugins: PluginOption[] = [];

  // å®šä¹‰æ’ä»¶æ‰«ææ—¶å¿½ç•¥çš„ç›®å½•
  const ignoreDir = {
    autoFrontmatter: ["**/@pages/**"],
  };

  // è‡ªåŠ¨ç”Ÿæˆ frontmatter æ’ä»¶
    const {
      pattern,
      globOptions = {},
      transform,
      permalinkPrefix = "pages",
    } = autoFrontmatterOption;

    // é»˜è®¤æ‰«æå…¨éƒ¨ MD æ–‡ä»¶
    if (!pattern) autoFrontmatterOption.pattern = "**/*.md";

    autoFrontmatterOption.globOptions = {
      ...autoFrontmatterOption.globOptions,
      ignore: [...ignoreDir.autoFrontmatter, ...(globOptions.ignore || [])],
    };

    // è‡ªå®šä¹‰ frontmatter å†…å®¹ï¼Œæ·»åŠ æ°¸ä¹…é“¾æ¥å’Œåˆ†ç±»
    autoFrontmatterOption.transform = (frontmatter, fileInfo) => {
      let transformResult = transform?.(frontmatter, fileInfo) || {};

     if (permalink) {
      transformResult = { ...transformResult, ...createPermalink(permalinkPrefix) };
    }
    if (!frontmatter.categories) {
      transformResult = { ...transformResult, ...createCategory(fileInfo, ["@fragment"]) };
      }
	  
	  /** ç»§ç»­æ·»åŠ ä½ æƒ³è¦çš„å­—æ®µï¼Œä»¿ç…§åˆ›å»º permalink æ°¸ä¹…é“¾æ¥åœ¨ä¸‹é¢å®ç°å³å¯ï¼Œ
        è¿”å›å€¼ç»“æ„{ key: value } 
   **/

      return Object.keys(transformResult).length ? { ...frontmatter, ...transformResult } : undefined;
    };

    plugins.push(AutoFrontmatter(autoFrontmatterOption));
  
  return {
    // ä½¿ç”¨æ°¸ä¹…é“¾æ¥æ’ä»¶éœ€è¦å¿½ç•¥æ­»é“¾æé†’
    ignoreDeadLinks: true,
    vite: {
      plugins: plugins as any,
      // è§£å†³é¡¹ç›®å¯åŠ¨åç»ˆç«¯æ‰“å° Scss çš„åºŸå¼ƒè­¦å‘Šï¼šThe legacy JS API is deprecated and will be removed in Dart Sass 2.0.0.
      css: { preprocessorOptions: { scss: { api: "modern" } } },
      optimizeDeps: {
        include: ["element-plus", "@giscus/vue", "@waline/client"],
      },
    },
    themeConfig: tkThemeConfig,
  };
}


/**
 * åˆ›å»º permalink æ°¸ä¹…é“¾æ¥
 */
export const createPermalink = () => {
  return {
    permalink: `/pages/${(Math.random() + Math.random()).toString(16).slice(2, 8)}`,
  };
};

/**
 * åˆ›å»º categories åˆ†ç±»åˆ—è¡¨
 *
 * @param fileInfo æ–‡ä»¶ä¿¡æ¯
 * @param ignore éœ€è¦å¿½ç•¥çš„æ–‡ä»¶åæˆ–ç›®å½•å
 */
export const createCategory = (fileInfo: FileInfo, ignore: string[] = []) => {
  const siteConfig: SiteConfig = (globalThis as any).VITEPRESS_CONFIG;
  const { locales = {} } = siteConfig.userConfig;

  const relativePathArr = fileInfo.relativePath.split("/");

  const categories: string[] = [];
  relativePathArr.forEach((item, index) => {
    // å»é™¤ã€Œåºå·.ã€çš„å‰ç¼€ï¼Œå¹¶è·å–æ–‡ä»¶å
    const filename = item.replace(/^\d+\./, "").split(".")?.[0] || "";

    // å…¼å®¹å›½é™…åŒ–åŠŸèƒ½ï¼Œå¦‚æœé…ç½®å¤šè¯­è¨€ï¼Œåˆ™ä¸æ·»åŠ å¤šè¯­è¨€æ ¹ç›®å½•å
    if (index !== relativePathArr.length - 1 && !locales[filename] && !ignore.includes(filename))
      categories.push(filename);
  });

  // [""] è¡¨ç¤ºæ·»åŠ ä¸€ä¸ªä¸ºç©ºçš„ categories
  return { categories: categories.length ? categories : [""] };
};


```

æ•ˆæœå¦‚ä¸‹ï¼š

```yaml
---
date: 2025-03-03 00:45:16
title: æ’ä»¶æµ‹è¯•
permalink: /pages/eb8f2f
categories:
  - guide
  - vue
---
```



> å¦‚æœ `transform` å‡½æ•°è¿”å›çš„ `frontmatter` å·²ç»åœ¨æ–‡ä»¶å­˜åœ¨ï¼ˆåªæ¯”è¾ƒ Key æ˜¯å¦ç›¸åŒï¼Œä¸æ¯”è¾ƒ Valueï¼‰ï¼Œåˆ™å¿½ç•¥ç”Ÿæˆã€‚



### 4ã€ ä½¿ç”¨

::: code-group
```typescript[config.ts]
import vpThemeConfig from "./theme/config/index";

const vpConfig = vpThemeConfig({
    vitePlugins: {
        autoFrontmatterOption: {
            pattern: "**/*.md",
            globOptions: { ignore: ["utils", "index.md", "login.md"] }
        },
        catalogueOption:{
            path: "docs",
            ignoreList: ["login.md"]
        },
    }
});


export default defineConfig({
    extends: vpConfig,
    ...
 )}
```
:::



